--BASE_EMKT_PREMIO_CONSUMIDOR_MODERNO_20250626
;WITH CTE_DEDUP AS (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY EMAIL_CORRIGIDO ORDER BY DT_RESPOSTA DESC) AS ROW_NUM
      FROM Grupo_Padrao_001_DBM.dbo.TMP_BASE_EMKT_PREMIO_CONSUMIDOR_MODERNO_20250626
)
SELECT IIF(QA_NOME = 'INVALIDO','Ol√°',PRIMEIRO_NOME) AS PRIMEIRO_NOME
      ,EMAIL_CORRIGIDO AS EMAIL
  FROM CTE_DEDUP
 WHERE TIPO_EMAIL = 'CORPORATIVO'
   AND EMAIL NOT LIKE '%teste%'
   AND QA_EMAIL = 'VALIDO'
   AND ROW_NUM = 1
